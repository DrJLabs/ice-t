# Codex-T Repository: Modernization & AI-Enablement Plan

**Overall Vision:** Transform the Codex-T repository into a bleeding-edge template for rapid, AI-assisted (specifically ChatGPT Codex) web application development. This plan focuses on robust dependency management, comprehensive testing, an optimized CI/CD pipeline, pristine code hygiene, autonomous capabilities, and a forward-looking design that fully leverages AI for development tasks.

---

## Modernization Checklist

- [x] Phase 0 ‚Äì AI Agent Guidance Setup
- [ ] Phase 1 ‚Äì Dependency Management & Environment Parity
- [ ] Phase 2 ‚Äì Testing Strategy & AI Collaboration
- [ ] Phase 3 ‚Äì CI Pipeline Optimization & Resilience
- [ ] Phase 4 ‚Äì Code Hygiene, Modularity & AI Readability
- [ ] Phase 5 ‚Äì Auto-Healing, Conflict Resolution & AI Resilience
- [ ] Phase 6 ‚Äì Forward Design Roadmap & Continuous AI Integration


## üìù Phase 0: AI Agent Guidance Setup

**Goal:** Establish a clear, modern, and effective guidance system for the ChatGPT Codex agent. This system will replace any legacy "Cursor rules" or ad-hoc `AGENTS.md` concepts with a structured approach.

**Rationale:** A well-defined AI guidance system is paramount for the AI to understand its role, tasks, constraints, and how to interact with the codebase effectively. This is foundational for all subsequent modernization efforts.

**Milestones & Tasks:**

1.  **Create `agents/` Directory Structure:**
    *   **Task:** Establish the `agents/` directory at the project root.
    *   **Sub-directories:**
        *   `agents/charter/`: For high-level mission, persona, and core principles.
        *   `agents/playbooks/`: For task-specific prompt templates and guides (e.g., new feature implementation, bug fixing, test generation).
        *   `agents/conventions/`: For coding standards, architectural guidelines, and specific tool usage patterns.
    *   **ChatGPT Codex Focus:** This structure will house the primary context and instructions for the agent.
    *   **Status:** Done

2.  **Develop AI Charter (`agents/charter/AI_CHARTER.md`):**
    *   **Task:** Define the AI's high-level mission, its persona (e.g., "Senior Python Full-Stack Developer"), core principles (e.g., "Prioritize clarity, testability, security"), communication protocols (how to ask for clarification, how to report errors), and ethical guidelines.
    *   **ChatGPT Codex Focus:** This document will be a key part of the initial prompt or context provided to Codex.
    *   **Status:** Done

3.  **Define Coding Conventions & Architectural Guidelines (`agents/conventions/CODING_CONVENTIONS.md`):**
    *   **Task:** Document non-negotiable coding standards (beyond what linters enforce), project-specific architectural patterns (e.g., vertical slice, DTO usage), API design principles, and preferred ways of using common libraries or frameworks.
    *   **Example:** "All new features in `src/ice_t/features/` must follow the domain, service, DTO pattern."
    *   **ChatGPT Codex Focus:** Provides explicit rules to reduce ambiguity and improve code quality generated by Codex.
    *   **Status:** Done

4.  **Develop Initial Playbooks (e.g., `agents/playbooks/IMPLEMENT_FEATURE.md`):**
    *   **Task:** Create templates or detailed guides for common development tasks. These playbooks will include prompt structures, expected inputs/outputs, and steps the AI should follow, including tool usage.
    *   **Example Playbook - Implement Feature:**
        *   Input: Feature specification (user story, requirements).
        *   Steps:
            1.  Clarify requirements if needed.
            2.  Identify affected modules or create new ones following the project structure.
            3.  Write domain logic and DTOs.
            4.  Implement service layer.
            5.  Write unit and integration tests (using `adaptive_test_runner.py`).
            6.  Update relevant documentation.
            7.  Run linters and type checkers.
    *   **ChatGPT Codex Focus:** Provides structured guidance for complex tasks, improving reliability and consistency of AI-generated contributions.
    *   **Status:** Done

5.  **Document Tool Usage for AI (`agents/conventions/TOOL_USAGE.md`):**
    *   **Task:** Clearly document how the AI should use available tools (e.g., `edit_file`, `run_terminal_cmd`, `adaptive_test_runner.py`), including when to use them and expected outcomes.
    *   **ChatGPT Codex Focus:** Essential for enabling the AI to autonomously interact with the development environment.
    *   **Status:** Done

---

## 1. Dependency Management & Environment Parity üöö

**Goal:** Ensure a robust, reproducible, and consistent dependency management system across all environments (local development, CI, and ChatGPT Codex agent environment), using `pyproject.toml` as the single source of truth.

**Rationale:** Version mismatches and environment inconsistencies are major sources of bugs and lost productivity, especially critical when an AI agent is involved, as highlighted by community experiences ([OpenAI Community: Codex Python dependencies install, but agent can't see them](https://community.openai.com/t/codex-python-dependencies-install-but-agent-cant-see-them/1268801)).

**Key Dependencies & Target State (from original plan, to be confirmed/updated):**
*   Python Version: 3.12 (ensure via `.python-version` or similar)
*   Key tools: Pytest, Ruff, Mypy, Pre-commit, Pydantic, etc. (versions to be pinned to latest stable LTS).

| Dependency Action             | Current Approach                                    | Proposed Modernized Approach                                                                                                | ChatGPT Codex Focus                                                                 | Status |
|-------------------------------|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|--------|
| **Source of Truth**           | `requirements.txt`, `dev-requirements.txt`          | `pyproject.toml` (core & optional dependencies via `[project.dependencies]` and `[project.optional-dependencies]`)            | Clear, single file for Codex to reference if it needs to suggest dependency additions. | To Do  |
| **Version Pinning**           | Some inconsistencies, manual updates                | `pip-compile` (from `pip-tools`) to generate locked `requirements.txt` and `dev-requirements.txt` from `pyproject.toml` | Ensures exact versions are installed in the Codex agent's environment.            | To Do  |
| **Environment Consistency**   | Potential for drift                                 | Use a `.python-version` file; ensure `setup_env.sh` (or equivalent commands) are run in ALL environments.        | Critical for agent reliability. Setup script *must* run in Codex environment.       | To Do  |
| **Installation Script**       | `setup_env.sh` (manual invocation)         | Refined `setup_env.sh` (or direct `pip install .[dev,optional]` commands) integrated into CI and Codex setup.     | Must be non-interactive and robust.                                                 | To Do  |
| **Dependency Audit & Update** | Table provided with targets                           | Verify and update all dependencies to latest stable/LTS. Resolve `ruff` mismatch. Update `pre-commit` spec to `4.x`.  | Ensures agent uses current library APIs.                                            | To Do  |
| **External Services (e.g. DB)** | N/A for core, but principle applies               | If added, ensure robust, non-interactive setup scripts for Codex environment (see [OpenAI Community: Codex MySQL Dependency Not Working](https://community.openai.com/t/codex-mysql-dependency-not-working/1266857)). | Prevents agent hangs on service startup.                                             | To Do  |

**Milestones & Tasks:**

1.  **Consolidate Dependencies into `pyproject.toml`:**
    *   **Task:** Move all core dependencies from `requirements.txt` to `[project.dependencies]` in `pyproject.toml`.
    *   **Task:** Move development dependencies from `dev-requirements.txt` to `[project.optional-dependencies.dev]` in `pyproject.toml`.
    *   **Task:** Move any other optional dependencies (ML, monitoring) to appropriate `[project.optional-dependencies.<group>]` sections.
    *   **ChatGPT Codex Focus:** Simplifies AI's understanding of project dependencies.
    *   **Status:** Done

2.  **Implement `pip-tools` for Lockfile Generation:**
    *   **Task:** Add `pip-tools` to dev dependencies.
    *   **Task:** Create `requirements.in` (if needed, or use `pyproject.toml` directly with `pip-compile`) for core dependencies.
    *   **Task:** Create `dev-requirements.in` for dev dependencies.
    *   **Task:** Update scripts/CI to run `pip-compile` to generate `requirements.txt` and `dev-requirements.txt`. Commit these lockfiles.
    *   **ChatGPT Codex Focus:** Guarantees the agent environment uses precisely the same dependency versions.
    *   **Status:** To Do

 3.  **Standardize Python Version:**
    *   **Task:** Create a `.python-version` file specifying Python 3.12 (or target).
    *   **Task:** Ensure local dev setup instructions, CI, and Codex environment setup respect this version.
    *   **ChatGPT Codex Focus:** Prevents version-related compatibility issues for the agent.
    *   **Status:** Done

4.  **Refine and Integrate `setup_env.sh` (or direct pip commands):**
    *   **Task:** Modify the script (or define `pip` commands) to install from `pyproject.toml` extras (e.g., `pip install .[dev,ml,monitoring]`).
    *   **Task:** Ensure this setup is explicitly part of the GitHub Actions workflow for CI and, crucially, part of the environment setup instructions for the ChatGPT Codex agent.
    *   **ChatGPT Codex Focus:** This is the mechanism to ensure the agent *sees* the correct dependencies.
    *   **Status:** To Do

5.  **Conduct Full Dependency Audit and Update:**
    *   **Task:** Systematically review each dependency in the original plan's table. Update to the latest stable/LTS version.
    *   **Task:** Resolve the `ruff` version mismatch (align `pyproject.toml` and ensure environment uses the specified version).
    *   **Task:** Update `pre-commit` hooks and `pyproject.toml` to reflect `pre-commit >= 4.0.1`.
    *   **Task:** Update version specifiers for NumPy, Scikit-learn, Bandit, Safety, Hypothesis, Build/Wheel as per the original plan.
    *   **ChatGPT Codex Focus:** Ensures the agent works with modern, secure, and stable library versions.
    *   **Status:** To Do

## 2. Testing Strategy & AI Collaboration üß™

**Goal:** Enhance the existing robust testing framework to be even more AI-friendly, ensuring rapid feedback, high reliability, and comprehensive coverage, with the `adaptive_test_runner.py` as a cornerstone for AI-driven test execution.

**Rationale:** A fast, reliable, and informative testing process is critical for an AI agent to iterate effectively and learn from its mistakes.

**Key Features (from original plan):**
*   ~94% coverage via Pytest.
*   `adaptive_test_runner.py` for in-process, self-healing, smart test selection.
*   Pytest markers for test categorization.

**Milestones & Tasks:**

1.  **Integrate `adaptive_test_runner.py` into AI Workflow:**
    *   **Task:** Ensure the AI Agent (via playbooks in `agents/playbooks/`) is instructed to use `adaptive_test_runner.py` after code changes.
    *   **Task:** Implement or refine the mechanism for the AI to pass changed file information to the runner for smart test selection.
    *   **Task:** Ensure the runner's output is clear and actionable for the AI (e.g., specific error messages, fixes attempted).
    *   **ChatGPT Codex Focus:** Enables the AI to autonomously run relevant tests and get immediate feedback.
    *   **Status:** Done

2.  **Refine Test Runner Self-Healing Capabilities:**
    *   **Task:** Review existing self-healing rules in `adaptive_test_runner.py`. Ensure fixes are logged clearly for AI learning.
    *   **Task:** Cautiously extend self-healing (e.g., for common, safe fixes), but avoid masking complex issues the AI should learn to solve.
    *   **ChatGPT Codex Focus:** Balances assistance with learning opportunities for the AI.
    *   **Status:** To Do

3.  **Enforce Strict Test Categorization with Markers:**
    *   **Task:** Verify and enforce strict usage of Pytest markers (`unit`, `integration`, `smoke`, `slow`, `external`) as defined in `pytest.ini` or `pyproject.toml`.
    *   **Task:** Ensure `sparc-test-fast` (or equivalent) *only* runs tests marked `unit`.
    *   **ChatGPT Codex Focus:** Allows AI to trigger appropriate test scopes quickly.
    *   **Status:** To Do

4.  **Strengthen Local Testing and CI Alignment:**
    *   **Task:** Integrate a fast test run (e.g., smoke tests or changed-files tests via adaptive runner) into pre-push hooks.
    *   **Task:** Ensure local test execution environment and CI environment are as identical as possible (dependencies, Python version).
    *   **ChatGPT Codex Focus:** Reduces "it works on my machine (or in Codex)" issues.
    *   **Status:** To Do

5.  **Optimize Local Parallel Test Execution:**
    *   **Task:** Ensure `pytest-xdist` is installed and configured.
    *   **Task:** Expose an option or default to using `pytest -n auto` for larger local test runs when appropriate (e.g., via `codex_test` or similar script).
    *   **ChatGPT Codex Focus:** Speeds up local validation for AI-generated code.
    *   **Status:** To Do

6.  **Expand Property-Based and Consider Mutation Testing:**
    *   **Task:** Identify critical modules for introducing/expanding Hypothesis property-based tests.
    *   **Task:** (Optional/Future) Evaluate and potentially integrate a mutation testing tool (e.g., `mutmut`) for on-demand or nightly runs to assess test suite thoroughness.
    *   **ChatGPT Codex Focus:** Helps AI generate more robust code by testing against a wider range of inputs.
    *   **Status:** To Do

## 3. CI Pipeline Optimization & Resilience üöÄ

**Goal:** Achieve a sub-5-minute CI/CD pipeline that is highly parallel, resilient, and leverages available hardware (16-core/128GB self-hosted runners) efficiently, with the ability to burst to cloud runners.

**Rationale:** A fast and reliable CI is the backbone of autonomous development, enabling rapid iteration and confident merging of AI contributions.

### ‚úÖ **CI Failure Analysis Infrastructure - COMPLETED**

**Automated Logging System:** Comprehensive CI failure analysis infrastructure has been implemented to enable AI-driven debugging and repair:

- **Failure Log Capture**: `save-failed-log.yml` workflow automatically captures detailed CI failure logs
- **Performance Metrics**: `collect-ci-metrics.yml` workflow tracks CI performance data in JSONL format
- **AI Integration**: Comprehensive documentation in rules and charter for AI agents to access and analyze logs
- **Automated Commits**: Logs are committed directly to repository bypassing all checks for immediate availability
- **Status**: ‚úÖ **Complete** - Infrastructure deployed and ready for AI-driven failure analysis

**Key Metrics & Targets (from original plan):**
*   Active self-hosted runners: 12 (+ optional cloud burst).
*   Parallel test groups: Target 6.
*   Total concurrent jobs: Target ~10-12.
*   Pipeline duration (PR): Target 3-6 minutes.
*   CPU/Memory Utilization: Optimal (e.g., 85-90% CPU, <80% RAM).

**Milestones & Tasks:**

1.  **Implement Expanded Test Parallelism:**
    *   **Task:** Refactor the GitHub Actions workflow (`turbo-ci-persistent-runners.yml`) to increase test matrix parallelism from 3 to 6 groups (core-unit, features-unit, utils-unit, integration, api-smoke, cli-smoke).
    *   **Task:** Adjust `max-parallel` for the test strategy accordingly (target 6).
    *   **ChatGPT Codex Focus:** Faster feedback on AI-generated PRs.
    *   **Status:** To Do

2.  **Tune Resource Utilization on Self-Hosted Runners:**
    *   **Task:** Ensure build steps use `MAKEFLAGS="-j16"` (or equivalent for available cores).
    *   **Task:** Monitor and adjust `PYTEST_XDIST_WORKER_COUNT` or use `-n auto` within parallel test jobs, balancing per-job parallelism with matrix parallelism to optimize CPU usage.
    *   **Task:** Investigate and implement `tmpfs` (RAM disk) for I/O-heavy operations (Git checkout, venv cache, pytest cache) if beneficial after profiling.
    *   **ChatGPT Codex Focus:** Maximizes speed of CI checks for AI contributions.
    *   **Status:** To Do

3.  **Implement Cloud Runner Bursting Strategy:**
    *   **Task:** Design and implement the conditional logic in GitHub Actions workflows to use `ubuntu-latest` runners if `env.USE_CLOUD_RUNNERS` is true.
    *   **Task:** Ensure dependency caching (via `actions/cache`) is enabled for cloud runner jobs.
    *   **Task:** Define a manual trigger or automated rule (e.g., based on queue length if feasible) for enabling `USE_CLOUD_RUNNERS`.
    *   **ChatGPT Codex Focus:** Maintains CI throughput even during high load from AI-generated PRs.
    *   **Status:** To Do

4.  **Optimize Caching Strategies:**
    *   **Task:** Maintain no-remote-cache for self-hosted runners (rely on persistent local cache).
    *   **Task:** Verify and refine the persistent virtualenv hashing mechanism for self-hosted runners.
    *   **Task:** Ensure `actions/cache` is effectively used for dependencies on cloud runner jobs.
    *   **ChatGPT Codex Focus:** Speeds up environment setup in all CI scenarios.
    *   **Status:** To Do

5.  **Refine Runner Labeling and Job Distribution:**
    *   **Task:** Review current runner labels. Consider more generic labels for matrix jobs (`self-hosted`, `linux`) to allow any available runner to pick them up, if appropriate for the specialized tasks.
    *   **Task:** Ensure all runners (self-hosted) have consistent environments.
    *   **ChatGPT Codex Focus:** Ensures AI-related jobs are processed without unnecessary queuing.
    *   **Status:** To Do

6.  **Monitor CI Metrics and Iterate:**
    *   **Task:** Establish a baseline for current CI metrics.
    *   **Task:** After implementing changes, continuously monitor pipeline duration, resource utilization, queue times, and reliability.
    *   **Task:** Make further adjustments as needed to meet performance targets.
    *   **ChatGPT Codex Focus:** Ensures the CI pipeline remains efficient as the AI's usage scales.
    *   **Status:** To Do

## 4. Code Hygiene, Modularity & AI Readability üóÉÔ∏è

**Goal:** Ensure the codebase is exceptionally clean, highly modular, well-documented, and easily understood by both human developers and AI agents, facilitating autonomous code generation and maintenance.

**Rationale:** A lean, well-structured, and self-documenting codebase is crucial for AI agents to navigate, understand context, and make accurate modifications.

**Key Principles (from original plan):**
*   `src/ice_t/` for core source.
*   Vertical slice architecture for features.
*   High code quality standards (linting, type hints, >94% test coverage).

**Milestones & Tasks:**

1.  **Aggressively Prune Legacy/Redundant Components:**
    *   **Task:** Thoroughly audit the entire codebase (including `scripts/`, `docs/`, `tests/`, `tools/` if it exists) for any superseded files, scripts, or documentation.
    *   **Task:** Delete or archive (outside the active repo) any identified legacy components.
    *   **Task:** Ensure there's a single, clear way to perform common tasks (e.g., one primary test runner script).
    *   **ChatGPT Codex Focus:** Reduces noise and confusion for the AI, preventing it from using outdated patterns or tools.
    *   **Status:** To Do

2.  **Enforce and Refine Code Modularity (Vertical Slices):**
    *   **Task:** Verify that all feature modules under `src/ice_t/features/` strictly adhere to the vertical slice architecture (domain, DTO, service layers per feature).
    *   **Task:** Ensure clear interfaces between modules, minimizing coupling. Core modules should not depend on feature-specific or dev-tool modules.
    *   **Task:** Update `agents/conventions/CODING_CONVENTIONS.md` to reflect these structural rules.
    *   **ChatGPT Codex Focus:** Enables AI to work on features in isolation with a clear understanding of boundaries.
    *   **Status:** To Do

3.  **Refactor `tools/` Directory (if it exists and is needed):**
    *   **Task:** If a `tools/` directory contains utilities, assess if they are core runtime logic (move to `src/ice_t/core` or `src/ice_t/utilities`) or development-only tools (consider `src/ice_t/devtools` or keep separate but clearly documented for AI if it needs to invoke them).
    *   **Task:** Ensure no core runtime code imports from development tools.
    *   **ChatGPT Codex Focus:** Clarifies for the AI what code is part of the application vs. auxiliary tooling.
    *   **Status:** To Do

4.  **Review and Update `templates/` Directory (if exists):**
    *   **Task:** If code/test templates exist, ensure they are up-to-date with current best practices and architectural patterns.
    *   **Task:** Remove or replace any outdated templates.
    *   **Task:** Document template usage in `agents/playbooks/` if AI is expected to use them.
    *   **ChatGPT Codex Focus:** Ensures AI generates new code consistent with project standards.
    *   **Status:** To Do

5.  **Enhance Code Documentation and Self-Documenting Code:**
    *   **Task:** Add/update docstrings in all public modules, classes, and functions, especially in complex areas like the adaptive test runner or core utilities. Focus on "why" not just "what."
    *   **Task:** Remove outdated or misleading comments (e.g., "TODO: future work" that is done or irrelevant).
    *   **Task:** Ensure code is as self-documenting as possible through clear naming and simple logic.
    *   **Task:** Keep `docs/` synchronized with any code refactoring.
    *   **ChatGPT Codex Focus:** Provides rich context for the AI, improving its understanding and ability to generate relevant code.
    *   **Status:** To Do

6.  **Maintain and Evolve Code Style and Static Analysis:**
    *   **Task:** Keep Ruff, Mypy, Black, isort, and other pre-commit hooks updated.
    *   **Task:** (Optional) Consider adding more focused static analysis if specific needs arise (e.g., `pylint` for deeper checks, `bandit` for security, already in use but keep rules updated).
    *   **Task:** Document these tools and their enforcement in `agents/conventions/CODING_CONVENTIONS.md`.
    *   **ChatGPT Codex Focus:** AI should be aware of these tools and aim to produce code that passes them.
    *   **Status:** To Do

## 5. Auto-Healing, Conflict Resolution & AI Resilience ü§ñ

**Goal:** Implement a highly autonomous CI/CD and development environment where the system can self-heal from common issues, attempt to resolve merge conflicts, and gracefully handle AI-driven changes, minimizing human intervention for routine problems.

**Rationale:** For an AI to develop efficiently at scale, the surrounding systems must be resilient to minor errors and capable of automated recovery or conflict management.

**Key Concepts (from original plan):**
*   Test runner self-healing (e.g., import fixes).
*   CI concurrency groups.
*   Intelligent auto-merge.

**Milestones & Tasks:**

1.  **Implement Automated Test Retries for Flakiness:**
    *   **Task:** Integrate `pytest-rerunfailures` into the test execution command in CI (and potentially locally for the adaptive runner).
    *   **Task:** Configure a small number of retries (e.g., 1-2) for all tests or specifically marked flaky tests.
    *   **Task:** Log retries clearly for later analysis.
    *   **ChatGPT Codex Focus:** Prevents AI from being blocked by transient test failures.
    *   **Status:** To Do

2.  **Develop Basic Automated Merge Conflict Resolution:**
    *   **Task:** (Research/Experimental) Design a GitHub Action triggered on PRs labeled for "auto-merge" that are in conflict.
    *   **Task:** The action should attempt to merge the `main` branch into the PR branch locally. If Git auto-resolves cleanly (or with only whitespace/trivial conflicts), the action pushes the merge commit.
    *   **Task:** If complex conflicts occur, the action comments on the PR, potentially tagging the AI or a human for manual resolution, or creating a task for the AI (via playbook).
    *   **ChatGPT Codex Focus:** Streamlines PR merging for AI-generated changes, handling simple cases automatically.
    *   **Status:** To Do

3.  **Implement Auto-Revert for `main` Branch Breakages by AI:**
    *   **Task:** Create a GitHub Action that triggers on pushes to `main` if CI tests fail.
    *   **Task:** If the failing commit author is the AI agent (e.g., `codex[bot]`) or from an automated source (e.g., dependabot), the action creates a PR to revert the offending commit(s). (Prefer PR over direct force-push for safety).
    *   **Task:** The revert PR should clearly explain why it was created.
    *   **ChatGPT Codex Focus:** Protects the `main` branch integrity while allowing the AI to iterate on a new PR.
    *   **Status:** To Do

4.  **Enhance Test Runner's Self-Healing Knowledge Base:**
    *   **Task:** Systematically identify common, safe-to-fix issues encountered during AI development (beyond current capabilities like missing `__init__.py`).
    *   **Task:** Examples:
        *   Detecting a missing dependency in `pyproject.toml` if an `ImportError` occurs for a known package, then suggesting (or, if configured, adding) it.
        *   Recognizing specific external service timeout patterns and suggesting a retry or marking the test as skipped with a warning.
    *   **Task:** Ensure all auto-fixes are clearly logged for AI and human review.
    *   **ChatGPT Codex Focus:** Makes the AI's red-green development loop more resilient and informative.
    *   **Status:** To Do

5.  **Improve Auto-Merge Workflow Resilience:**
    *   **Task:** Maintain the existing robust auto-merge system.
    *   **Task:** Add enhanced logging and alerting (e.g., PR comments) if auto-merge fails for non-obvious reasons (e.g., GitHub API issues despite met conditions).
    *   **Task:** Ensure branch protection rules are perfectly synchronized with auto-merge criteria and CI status checks. Update branch protection whenever CI checks are modified.
    *   **ChatGPT Codex Focus:** Ensures AI-generated PRs flow smoothly through the merge process.
    *   **Status:** To Do

## 6. Forward Design Roadmap & Continuous AI Integration üåÖ

**Goal:** Position Codex-T as a continuously evolving, lightweight, and high-performance template for autonomous web app development, with deep and seamless integration of ChatGPT Codex capabilities.

**Rationale:** The project should not only be modernized for current best practices but also designed to adapt to future advancements in AI-driven development.

**Key Themes (from original plan):**
*   Lightweight core, modular add-ons.
*   Rapid dev loop (hot-reloading, fast tests).
*   Mass PR handling.
*   Autonomous development integration.
*   Continuous refinement.

**Milestones & Tasks:**

1.  **Define and Maintain a Minimal Core Template:**
    *   **Task:** After initial cleanup (Phase 4), strictly define what constitutes the "core" template (essential `src/` layout, one example feature, testing, CI, `agents/` structure).
    *   **Task:** Document how to clone/generate a new project from this minimal core.
    *   **Task:** Ensure features not universally needed are truly optional (via `pyproject.toml` extras and isolated code paths).
    *   **ChatGPT Codex Focus:** Provides a clean slate for AI to build upon for new projects.
    *   **Status:** To Do

2.  **Formalize Modular Feature Add-on Strategy:**
    *   **Task:** Clearly document how to enable/disable optional modules (e.g., "AI Agents system," "Semantic Search/ML," "Real-time Monitoring") using `pyproject.toml` extras and conditional imports/configurations.
    *   **Task:** Provide playbooks or guides in `agents/playbooks/` for the AI on how to integrate or work with these optional modules.
    *   **ChatGPT Codex Focus:** Allows AI to request or enable specific capabilities as needed for a project.
    *   **Status:** To Do

3.  **Optimize for "One-Shot" AI Coding Loop:**
    *   **Task:** (If applicable to project type) Integrate hot-reloading for web development (e.g., Uvicorn/Starlette for FastAPI).
    *   **Task:** Ensure the development environment (local and potentially a "preview" environment for AI) supports immediate feedback from code changes (server reload, adaptive tests).
    *   **Task:** Document this rapid dev loop in `agents/charter/AI_CHARTER.md` as the preferred mode of operation for the AI.
    *   **ChatGPT Codex Focus:** Maximizes AI's iterative speed and efficiency.
    *   **Status:** To Do

4.  **Implement Advanced Quality Gates for Mass PRs:**
    *   **Task:** Maintain and potentially tighten existing quality gates (coverage >94%, linting, type checking, security scans).
    *   **Task:** (Future) Consider incorporating performance benchmarks (e.g., using `performance_benchmark.py` if available) into CI (nightly or on-demand) to gate PRs that cause significant regressions.
    *   **Task:** Ensure all quality gates are non-negotiable for auto-merge.
    *   **ChatGPT Codex Focus:** Ensures AI contributions consistently meet high quality standards, even at scale.
    *   **Status:** To Do

5.  **Enhance AI Telemetry and Learning Mechanisms:**
    *   **Task:** Expand the concept of `.test_learning.json` (from adaptive runner) or create a new telemetry system to log outcomes of AI-made commits/PRs (e.g., test failures, CI issues, auto-reverts, successful merges, type of changes).
    *   **Task:** (Research) Investigate how this structured telemetry could be fed back to the AI (or a meta-AI) to improve its strategies over time.
    *   **Task:** Use the `add_to_memory` tool strategically to capture key learnings from AI interactions and PR reviews.
    *   **ChatGPT Codex Focus:** Creates a feedback loop for continuous improvement of the AI's performance on this codebase.
    *   **Status:** To Do

6.  **Establish Continuous Refinement Process:**
    *   **Task:** Set up automated CI jobs or scripts to generate periodic "health reports" (e.g., outdated dependencies, slow tests, code complexity metrics).
    *   **Task:** Use these reports to identify areas for further optimization or refactoring.
    *   **Task:** Regularly review and update the AI guidance documents in `agents/` based on observed AI behavior and project evolution.
    *   **ChatGPT Codex Focus:** Ensures the project and its AI integration remain state-of-the-art.
    *   **Status:** To Do

---

**Sources Consulted (from original plan and new additions):**
*   Original Codex-T README and Changelog.
*   Original dependency listings and installed versions.
*   Original CI Workflow config (`turbo-ci-persistent-runners.yml`).
*   Original Auto-merge system guide.
*   Original Adaptive Test Runner and Codex commands documentation.
*   Original Cleanup summary.
*   [OpenAI Community: Codex Python dependencies install, but agent can't see them](https://community.openai.com/t/codex-python-dependencies-install-but-agent-cant-see-them/1268801)
*   [OpenAI Community: Codex MySQL Dependency Not Working](https://community.openai.com/t/codex-mysql-dependency-not-working/1266857)
*   General best practices for Python development, CI/CD, and AI prompt engineering.
